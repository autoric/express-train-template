#!/usr/bin/env node

var path = require('path'),
    fs = require('fs'),
    util = require('util');

var dir = process.cwd();
var src,
    dst = path.join(dir, '/.env.json');


var exists = fs.existsSync(dst);
  if (exists) {
    console.log('Environment config (.env.js) found.');
  }
  else {
    var env = process.env.NODE_ENV;
    var src = path.join(dir, '/config', env+'.env.json');
    if(!fs.existsSync(src)){
        src = path.join(dir, '/config', 'default.env.json');
    }
    console.log('Environment config (.env.js) not found, copying from %s...', src);
    var rs = fs.createReadStream(src);
    var ws = fs.createWriteStream(dst);
    util.pump(rs, ws, function(err, result) {
      if (err) throw err;
      console.log('done.');
    });
  }